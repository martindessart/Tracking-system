f3/f2 #Check ratio
## Check visually that individuals are correctly identified and that data looks consistent ----
ggplot(IR2)+
geom_density(aes(x=frame,colour=ID))
ggplot(IR2)+
geom_line(aes(x=frame,y=pos_x,colour=ID))
rm(list=ls())
setwd("/Users/martin/Documents/1_PhD_Local/3_Data/CX_tracked")
raw1<-read.table("C8A_tracked.csv", sep=",",header=T)
raw2<-read.table("C8T2_tracked.csv", sep=",",header=T)
raw3<-read.table("C8T3_tracked.csv", sep=",",header=T)
#Replace good ID ----
classId<- function(rr) {
df_tot<-data.frame()
n_ind<-c("A","B","C","D","E","F","G","H","I","J")
#calculate distance
dist<-(max(rr$pos_x)+30)-min(rr$pos_x)
c<-dist/10
#filter and extract
for(i in 0:9) {
namnam<-paste("st",n_ind[i],sep="")
namnam<-rr %>%
filter(pos_x>((i*c)) & pos_x<(((i+1)*c))) %>%
mutate(ID=i+1)
df_tot<-rbind(df_tot,namnam)
}
return(df_tot)
}
classId2<- function(rr) {
df_tot<-data.frame()
n_ind<-c("A","B","C","D","E","F","G","H")
#calculate distance
dist<-(max(rr$pos_x)+30)-min(rr$pos_x)
c<-dist/8
#filter and extract
for(i in 0:7) {
namnam<-paste("st",n_ind[i],sep="")
namnam<-rr %>%
filter(pos_x>((i*c)) & pos_x<(((i+1)*c))) %>%
mutate(ID=i+1)
df_tot<-rbind(df_tot,namnam)
}
return(df_tot)
}
classId3<- function(rr) {
df_tot<-data.frame()
n_ind<-c("A","B","C","D","E")
#calculate distance
dist<-(max(rr$pos_x)+30)-min(rr$pos_x)
c<-dist/5
#filter and extract
for(i in 0:4) {
namnam<-paste("st",n_ind[i],sep="")
namnam<-rr %>%
filter(pos_x>((i*c)) & pos_x<(((i+1)*c))) %>%
mutate(ID=i+1)
df_tot<-rbind(df_tot,namnam)
}
return(df_tot)
}
#raw1: sti1 Ã  19min45s ----
#1185*25 = 29625
r1<-raw1 %>%
filter(frame>29500) %>%
mutate(frame=frame-29500)
IR1<-classId2(r1)
IR1<-IR1 %>%
mutate(ID=ID+2) %>%
mutate(pos_x=pos_x+250)
IR1$ID<-as.factor(IR1$ID)
IR1<-IR1 %>%
select(!id) %>%
mutate(cat="ITI")
#raw2 ----
r2<-raw2 %>%
filter(frame<30100) %>%
mutate(frame=frame+645)
IR2<-classId(r2)
IR2$ID<-as.factor(IR2$ID)
IR2<-IR2 %>%
filter(ID!=2) %>%
select(!id) %>%
mutate(cat="ITI")
#raw3 ----
r3<-raw3 %>%
mutate(frame=frame+30100)
#ggplot(r3)+
# geom_line(aes(x=frame,y=-pos_y,colour=id))
IR3<-classId3(r3)
IR3<-IR3 %>%
mutate(ID=ID+5) %>%
mutate(pos_x=pos_x+620)
IR3$ID<-as.factor(IR3$ID)
IR3<-IR3 %>%
select(!id) %>%
mutate(cat="ITI")
IR<-bind_rows(IR1,IR2,IR3) %>%
filter(ID==6|ID==7|ID==8|ID==9|ID==10)
#Filter ----
IR2<-IR %>%
group_by(ID) %>%
#Pos_Y
mutate(sec=round(frame/10,digits=0)) %>%
mutate(y2=rollmean(pos_y,10,na.pad=TRUE)) %>%
mutate(m=lag(y2)) %>% #shift column posy from one position --> lag c'est du pck de base R stats
mutate(dY=m-y2) %>% #create speed
mutate(absdY=abs(dY)) %>% #absolu dt
mutate(v=lag(dY)) %>%  #shift column dt from one position
mutate(dv=v-dY) %>%  #create acceleration
#R
mutate(x2=rollmean(pos_x,10,na.pad=TRUE)) %>%
mutate(r2=sqrt(x2*x2+y2*y2)) %>%  #create r vector
mutate(mr=lag(r2)) %>% #shift column pos r from one position
mutate(dR=mr-r2) %>% #create difference between 2 positions
mutate(absdR=abs(dR)) %>%
group_by(ID,sec) %>%
summarise(frame=mean(frame),
pos_y=mean(pos_y),
pos_x=mean(pos_x),
dY=sum(dY,na.rm=T),
absdY=sum(absdY,na.rm=T),
dv=sum(dv,na.rm=T),
absdR=sum(absdR,na.rm=T),
size=mean(size,na.rm=T))
f1<-max(IR2$frame) #max frames
f2<-f1*5
f3<-nrow(IR)
f3/f2
#Check ----
ggplot(IR2)+
geom_density(aes(x=frame,colour=ID))
ggplot(IR2)+
geom_line(aes(x=frame,y=pos_x,colour=ID))
rm(list=ls())
## Open file ----
setwd("/Users/martin/Desktop/2)Data/1_Raw/Culex")
filename="R11"
#2 TRACKING IN 3 PARTS
raw1<-read.table(file=paste(filename,"_A_tracked.csv",sep=""), sep=",",header=T)
raw2<-read.table(file=paste(filename,"_B_tracked.csv",sep=""), sep=",",header=T)
raw3<-read.table(file=paste(filename,"_B_tracked.csv",sep=""), sep=",",header=T)
r1<-raw1 %>%
filter(frame>29500) %>%
mutate(frame=frame-29500)
IR1<-classId2(r1)
IR1<-IR1 %>%
mutate(ID=ID+2) %>%
mutate(pos_x=pos_x+250)
IR1$ID<-as.factor(IR1$ID)
rm(list=ls())
## Open file ----
setwd("/Users/martin/Desktop/2)Data/1_Raw/Culex")
filename="R11"
#2 TRACKING IN 3 PARTS
raw1<-read.table(file=paste(filename,"_A_tracked.csv",sep=""), sep=",",header=T)
raw2<-read.table(file=paste(filename,"_B_tracked.csv",sep=""), sep=",",header=T)
raw3<-read.table(file=paste(filename,"_B_tracked.csv",sep=""), sep=",",header=T)
classId<- function(rr) {
df_tot<-data.frame()
n_ind<-c("A","B","C","D","E","F","G","H","I","J") # 10 individuals per experiment
#calculate x horizontal distance
dist<-(max(rr$pos_x)+30)-min(rr$pos_x) # total distance
c<-dist/10 # x distance for each individual
#filter and extract
for(i in 0:9) {
namnam<-paste("st",n_ind[i],sep="")
namnam<-rr %>%
filter(pos_x>((i*c)) & pos_x<(((i+1)*c))) %>%
mutate(ID=i+1)
df_tot<-rbind(df_tot,namnam)
}
return(df_tot)
}
classId2<- function(rr) {
df_tot<-data.frame()
n_ind<-c("A","B","C","D","E","F","G","H") # 8 individuals HERE
#calculate x horizontal distance
dist<-(max(rr$pos_x)+30)-min(rr$pos_x) # total distance
c<-dist/8 # x distance for each individual
#filter and extract
for(i in 0:7) {
namnam<-paste("st",n_ind[i],sep="")
namnam<-rr %>%
filter(pos_x>((i*c)) & pos_x<(((i+1)*c))) %>%
mutate(ID=i+1)
df_tot<-rbind(df_tot,namnam)
}
return(df_tot)
}
classId3<- function(rr) {
df_tot<-data.frame()
n_ind<-c("A","B","C","D","E") # 5 individuals HERE
#calculate x horizontal distance
dist<-(max(rr$pos_x)+30)-min(rr$pos_x) # total distance
c<-dist/5 # x distance for each individual
#filter and extract
for(i in 0:4) {
namnam<-paste("st",n_ind[i],sep="")
namnam<-rr %>%
filter(pos_x>((i*c)) & pos_x<(((i+1)*c))) %>%
mutate(ID=i+1)
df_tot<-rbind(df_tot,namnam)
}
return(df_tot)
}
r1<-raw1 %>%
filter(frame>29500) %>%
mutate(frame=frame-29500)
IR1<-classId2(r1)
IR1<-IR1 %>%
mutate(ID=ID+2) %>%
mutate(pos_x=pos_x+250)
IR1$ID<-as.factor(IR1$ID)
IR1<-IR1 %>%
select(!id) %>%
mutate(cat="ITI")
r2<-raw2 %>%
filter(frame<30100) %>%
mutate(frame=frame+645)
IR2<-classId(r2)
IR2$ID<-as.factor(IR2$ID)
IR2<-IR2 %>%
filter(ID!=2) %>%
select(!id) %>%
mutate(cat="ITI")
r3<-raw3 %>%
mutate(frame=frame+30100)
IR3<-classId3(r3)
IR3<-IR3 %>%
mutate(ID=ID+5) %>%
mutate(pos_x=pos_x+620)
IR3$ID<-as.factor(IR3$ID)
IR3<-IR3 %>%
select(!id) %>%
mutate(cat="ITI")
IR<-bind_rows(IR1,IR2,IR3) %>%
filter(ID==6|ID==7|ID==8|ID==9|ID==10)
## Filter ----
# we create different variables to create the distance between two position
# and average data by rollmean function
IR2<-IR %>%
group_by(ID) %>%
mutate(sec=round(frame/10,digits=0)) %>% #Average by 10
mutate(y2=rollmean(pos_y,10,na.pad=TRUE)) %>% #Moving average
mutate(m=lag(y2)) %>% #shift column posy from one position
mutate(dY=m-y2) %>% #create speed = difference from 2 successive positions
mutate(absdY=abs(dY)) %>% #create absolute dt
group_by(ID,sec) %>%
summarise(frame=mean(frame),
pos_y=mean(pos_y),
pos_x=mean(pos_x),
dY=sum(dY,na.rm=T),
absdY=sum(absdY,na.rm=T))
# we have also compared our data frames with the theorethical maximum number of frames
f1<-max(IR2$frame) #max frames
f2<-f1*nlevels(IR2$ID) #f1 x 10 individuals
f3<-nrow(IR) #number of lines
f3/f2 #Check ratio
## Check visually that individuals are correctly identified and that data looks consistent ----
ggplot(IR2)+
geom_density(aes(x=frame,colour=ID))
ggplot(IR2)+
geom_line(aes(x=frame,y=pos_x,colour=ID))
rm(list=ls())
## Open file ----
setwd("/Users/martin/Desktop/2)Data/1_Raw/Culex")
filename="R11"
#2 TRACKING IN 3 PARTS
raw1<-read.table(file=paste(filename,"_A_tracked.csv",sep=""), sep=",",header=T)
raw2<-read.table(file=paste(filename,"_B_tracked.csv",sep=""), sep=",",header=T)
raw3<-read.table(file=paste(filename,"_B_tracked.csv",sep=""), sep=",",header=T)
classId<- function(rr) {
df_tot<-data.frame()
n_ind<-c("A","B","C","D","E","F","G","H","I","J") # 10 individuals per experiment
#calculate x horizontal distance
dist<-(max(rr$pos_x)+30)-min(rr$pos_x) # total distance
c<-dist/10 # x distance for each individual
#filter and extract
for(i in 0:9) {
namnam<-paste("st",n_ind[i],sep="")
namnam<-rr %>%
filter(pos_x>((i*c)) & pos_x<(((i+1)*c))) %>%
mutate(ID=i+1)
df_tot<-rbind(df_tot,namnam)
}
return(df_tot)
}
classId2<- function(rr) {
df_tot<-data.frame()
n_ind<-c("A","B","C","D","E","F","G","H") # 8 individuals HERE
#calculate x horizontal distance
dist<-(max(rr$pos_x)+30)-min(rr$pos_x) # total distance
c<-dist/8 # x distance for each individual
#filter and extract
for(i in 0:7) {
namnam<-paste("st",n_ind[i],sep="")
namnam<-rr %>%
filter(pos_x>((i*c)) & pos_x<(((i+1)*c))) %>%
mutate(ID=i+1)
df_tot<-rbind(df_tot,namnam)
}
return(df_tot)
}
classId3<- function(rr) {
df_tot<-data.frame()
n_ind<-c("A","B","C","D","E") # 5 individuals HERE
#calculate x horizontal distance
dist<-(max(rr$pos_x)+30)-min(rr$pos_x) # total distance
c<-dist/5 # x distance for each individual
#filter and extract
for(i in 0:4) {
namnam<-paste("st",n_ind[i],sep="")
namnam<-rr %>%
filter(pos_x>((i*c)) & pos_x<(((i+1)*c))) %>%
mutate(ID=i+1)
df_tot<-rbind(df_tot,namnam)
}
return(df_tot)
}
r1<-raw1 %>%
filter(frame>29500) %>%
mutate(frame=frame-29500)
IR1<-classId2(r1)
IR1<-IR1 %>%
mutate(ID=ID+2) %>%
mutate(pos_x=pos_x+250)
IR1$ID<-as.factor(IR1$ID)
IR1<-IR1 %>%
select(!id) %>%
mutate(cat="ITI")
r2<-raw2 %>%
filter(frame<30100) %>%
mutate(frame=frame+645)
IR2<-classId(r2)
IR2$ID<-as.factor(IR2$ID)
IR2<-IR2 %>%
filter(ID!=2) %>%
select(!id) %>%
mutate(cat="ITI")
r3<-raw3 %>%
mutate(frame=frame+30100)
IR3<-classId3(r3)
IR3<-IR3 %>%
mutate(ID=ID+5) %>%
mutate(pos_x=pos_x+620)
IR3$ID<-as.factor(IR3$ID)
IR3<-IR3 %>%
select(!id) %>%
mutate(cat="ITI")
IR<-bind_rows(IR1,IR2,IR3) %>%
filter(ID==6|ID==7|ID==8|ID==9|ID==10)
## Filter ----
# we create different variables to create the distance between two position
# and average data by rollmean function
IR2<-IR %>%
group_by(ID) %>%
mutate(sec=round(frame/10,digits=0)) %>% #Average by 10
mutate(y2=rollmean(pos_y,10,na.pad=TRUE)) %>% #Moving average
mutate(m=lag(y2)) %>% #shift column posy from one position
mutate(dY=m-y2) %>% #create speed = difference from 2 successive positions
mutate(absdY=abs(dY)) %>% #create absolute dt
group_by(ID,sec) %>%
summarise(frame=mean(frame),
pos_y=mean(pos_y),
pos_x=mean(pos_x),
dY=sum(dY,na.rm=T),
absdY=sum(absdY,na.rm=T))
# we have also compared our data frames with the theorethical maximum number of frames
f1<-max(IR2$frame) #max frames
f2<-f1*nlevels(IR2$ID) #f1 x 10 individuals
f3<-nrow(IR) #number of lines
f3/f2 #Check ratio
f2<-f1*5 #f1 x 5 individuals
f3<-nrow(IR) #number of lines
f3/f2 #Check ratio
# we have also compared our data frames with the theorethical maximum number of frames
f1<-max(IR2$frame) #max frames
f2<-f1*5 #f1 x 5 individuals
f3<-nrow(IR) #number of lines
f3/f2 #Check ratio
## Check visually that individuals are correctly identified and that data looks consistent ----
ggplot(IR2)+
geom_density(aes(x=frame,colour=ID))
ggplot(IR2)+
geom_line(aes(x=frame,y=pos_x,colour=ID))
rm(list=ls())
rm(list=ls())
## Open file ----
setwd("/Users/martin/Desktop/2)Data/1_Raw/Culex")
filename="R11"
#2 TRACKING IN 3 PARTS
raw1<-read.table(file=paste(filename,"_A_tracked.csv",sep=""), sep=",",header=T)
raw2<-read.table(file=paste(filename,"_B_tracked.csv",sep=""), sep=",",header=T)
raw3<-read.table(file=paste(filename,"_B_tracked.csv",sep=""), sep=",",header=T)
#Replace good ID ----
classId<- function(rr) {
df_tot<-data.frame()
n_ind<-c("A","B","C","D","E","F","G","H","I","J")
#calculate distance
dist<-(max(rr$pos_x)+30)-min(rr$pos_x)
c<-dist/10
#filter and extract
for(i in 0:9) {
namnam<-paste("st",n_ind[i],sep="")
namnam<-rr %>%
filter(pos_x>((i*c)) & pos_x<(((i+1)*c))) %>%
mutate(ID=i+1)
df_tot<-rbind(df_tot,namnam)
}
return(df_tot)
}
classId2<- function(rr) {
df_tot<-data.frame()
n_ind<-c("A","B","C","D","E","F","G","H")
#calculate distance
dist<-(max(rr$pos_x)+30)-min(rr$pos_x)
c<-dist/8
#filter and extract
for(i in 0:7) {
namnam<-paste("st",n_ind[i],sep="")
namnam<-rr %>%
filter(pos_x>((i*c)) & pos_x<(((i+1)*c))) %>%
mutate(ID=i+1)
df_tot<-rbind(df_tot,namnam)
}
return(df_tot)
}
classId3<- function(rr) {
df_tot<-data.frame()
n_ind<-c("A","B","C","D","E")
#calculate distance
dist<-(max(rr$pos_x)+30)-min(rr$pos_x)
c<-dist/5
#filter and extract
for(i in 0:4) {
namnam<-paste("st",n_ind[i],sep="")
namnam<-rr %>%
filter(pos_x>((i*c)) & pos_x<(((i+1)*c))) %>%
mutate(ID=i+1)
df_tot<-rbind(df_tot,namnam)
}
return(df_tot)
}
#raw1: sti1 Ã  19min45s ----
#1185*25 = 29625
r1<-raw1 %>%
filter(frame>29500) %>%
mutate(frame=frame-29500)
IR1<-classId2(r1)
IR1<-IR1 %>%
mutate(ID=ID+2) %>%
mutate(pos_x=pos_x+250)
IR1$ID<-as.factor(IR1$ID)
IR1<-IR1 %>%
select(!id) %>%
mutate(cat="ITI")
#raw2 ----
r2<-raw2 %>%
filter(frame<30100) %>%
mutate(frame=frame+645)
IR2<-classId(r2)
IR2$ID<-as.factor(IR2$ID)
IR2<-IR2 %>%
filter(ID!=2) %>%
select(!id) %>%
mutate(cat="ITI")
#raw3 ----
r3<-raw3 %>%
mutate(frame=frame+30100)
#ggplot(r3)+
# geom_line(aes(x=frame,y=-pos_y,colour=id))
IR3<-classId3(r3)
IR3<-IR3 %>%
mutate(ID=ID+5) %>%
mutate(pos_x=pos_x+620)
IR3$ID<-as.factor(IR3$ID)
IR3<-IR3 %>%
select(!id) %>%
mutate(cat="ITI")
IR<-bind_rows(IR1,IR2,IR3) %>%
filter(ID==6|ID==7|ID==8|ID==9|ID==10)
#Filter ----
IR2<-IR %>%
group_by(ID) %>%
#Pos_Y
mutate(sec=round(frame/10,digits=0)) %>%
mutate(y2=rollmean(pos_y,10,na.pad=TRUE)) %>%
mutate(m=lag(y2)) %>% #shift column posy from one position --> lag c'est du pck de base R stats
mutate(dY=m-y2) %>% #create speed
mutate(absdY=abs(dY)) %>% #absolu dt
mutate(v=lag(dY)) %>%  #shift column dt from one position
mutate(dv=v-dY) %>%  #create acceleration
#R
mutate(x2=rollmean(pos_x,10,na.pad=TRUE)) %>%
mutate(r2=sqrt(x2*x2+y2*y2)) %>%  #create r vector
mutate(mr=lag(r2)) %>% #shift column pos r from one position
mutate(dR=mr-r2) %>% #create difference between 2 positions
mutate(absdR=abs(dR)) %>%
group_by(ID,sec) %>%
summarise(frame=mean(frame),
pos_y=mean(pos_y),
pos_x=mean(pos_x),
dY=sum(dY,na.rm=T),
absdY=sum(absdY,na.rm=T),
dv=sum(dv,na.rm=T),
absdR=sum(absdR,na.rm=T),
size=mean(size,na.rm=T))
f1<-max(IR2$frame) #max frames
f2<-f1*5
f3<-nrow(IR)
f3/f2S
f3/f2
