rep=mean(rep,na.rm=T)) %>% ungroup()
C1_An<-F_Anopheles %>%
filter(ct!=3) %>%
filter(cat==1|cat==10) %>%
group_by(ct,sp,ID,cat) %>%
summarise(dY=mean(dY,na.rm = T),
rep=mean(rep,na.rm=T)) %>% ungroup()
C1<-bind_rows(C1_Ae,C1_Cx,C1_An)
mae<-glm(rep~cat*sp, data=C1, family="binomial")
yv <- predict(mae,type="link",se.fit=TRUE)
yAE<-data.frame(yv$fit,yv$se.fit,C1$cat,C1$ct,C1$sp)
yd1P<-yAE %>% rename(sp=C1.sp) %>% rename(cat=C1.cat)
inv<-family(mae)$linkinv
ggplot(data=C1,aes(x=cat,y=rep))+
geom_pointrange(data=yd1P,aes(x=cat,y=inv(yv.fit),
ymin=inv(yv.fit-1.96*yv.se.fit),
ymax=inv((yv.fit+1.96*yv.se.fit)),
group=sp,color=sp),size=1)+
theme_classic() +
labs(y="Responding individuals (% PI = 1)",x="Trial")+
theme(plot.title = element_text(hjust = 0.5))+
theme(plot.title = element_text(size=22,face = "bold"))+
theme(axis.text=element_text(size=20,color="black"),
axis.title=element_text(size=20,color="black"))+
scale_color_manual(values=c("#531B93","#009193","#941751"))+
scale_fill_manual(values=c("#531B93","#009193","#941751"))+
theme(legend.title = element_text(size=20),
legend.text = element_text(size=20))+
guides(colour=guide_legend(title="Species"))+
theme(legend.position = "none",
strip.text = element_text(size = 18))+
stat_compare_means(comparisons = list(c("1","10")),
method.args = list(alternative = "greater"),
aes(label = ..p.signif..),
bracket.size = 1,size=5)+
facet_wrap(~sp)
C1_Ae<-F_Aedes %>%
filter(ct!=3) %>%
filter(cat==1|cat==10) %>%
group_by(ct,sp,ID,cat) %>%
summarise(dY=mean(dY,na.rm = T),
rep=mean(rep,na.rm=T)) %>% ungroup()
C1_Cx<-F_Culex %>%
filter(ct!=3) %>%
filter(cat==1|cat==10) %>%
group_by(ct,sp,ID,cat) %>%
summarise(dY=mean(dY,na.rm = T),
rep=mean(rep,na.rm=T)) %>% ungroup()
C1_An<-F_Anopheles %>%
filter(ct!=3) %>%
filter(cat==1|cat==10) %>%
group_by(ct,sp,ID,cat) %>%
summarise(dY=mean(dY,na.rm = T),
rep=mean(rep,na.rm=T)) %>% ungroup()
C1<-bind_rows(C1_Ae,C1_Cx,C1_An)
mae<-glm(rep~cat*sp, data=C1, family="binomial")
yv <- predict(mae,type="link",se.fit=TRUE)
yAE<-data.frame(yv$fit,yv$se.fit,C1$cat,C1$ct,C1$sp)
yd1P<-yAE %>% rename(sp=C1.sp) %>% rename(cat=C1.cat)
inv<-family(mae)$linkinv
ggplot(data=C1,aes(x=cat,y=rep))+
geom_pointrange(data=yd1P,aes(x=cat,y=inv(yv.fit),
ymin=inv(yv.fit-1.96*yv.se.fit),
ymax=inv((yv.fit+1.96*yv.se.fit)),
group=sp,color=sp),size=1)+
theme_classic() +
labs(y="Responding individuals (% PI = 1)",x="Trial")+
theme(plot.title = element_text(hjust = 0.5))+
theme(plot.title = element_text(size=22,face = "bold"))+
theme(axis.text=element_text(size=20,color="black"),
axis.title=element_text(size=20,color="black"))+
scale_color_manual(values=c("#531B93","#009193","#941751"))+
scale_fill_manual(values=c("#531B93","#009193","#941751"))+
theme(legend.title = element_text(size=20),
legend.text = element_text(size=20))+
guides(colour=guide_legend(title="Species"))+
theme(legend.position = "none",
strip.text = element_text(size = 18))+
stat_compare_means(comparisons = list(c("1","10")),
method.args = list(alternative = "greater"),
aes(label = ..p.signif..),
bracket.size = 1,size=5)+
facet_wrap(~sp)
mae<-glm(dY~cat*sp, data=C1)
yv <- predict(mae,type="link",se.fit=TRUE)
yAE<-data.frame(yv$fit,yv$se.fit,C1$cat,C1$ct,C1$sp)
yd1V<-yAE %>% rename(sp=C1.sp) %>% rename(cat=C1.cat)
inv<-family(mae)$linkinv
ggplot(data=C1,aes(x=cat,y=dY))+
geom_pointrange(data=yd1V,aes(x=cat,y=inv(yv.fit),
ymin=inv(yv.fit-1.96*yv.se.fit),
ymax=inv((yv.fit+1.96*yv.se.fit)),
group=sp,color=sp),size=1)+
theme_classic() +
labs(y="Vertical Distance (mm)",x="Trial")+
theme(plot.title = element_text(hjust = 0.5))+
theme(plot.title = element_text(size=22,face = "bold"))+
theme(axis.text=element_text(size=20,color="black"),
axis.title=element_text(size=20,color="black"))+
scale_color_manual(values=c("#531B93","#009193","#941751"))+
scale_fill_manual(values=c("#531B93","#009193","#941751"))+
theme(legend.title = element_text(size=20),
legend.text = element_text(size=20))+
guides(colour=guide_legend(title="Species"))+
theme(legend.position = "none",
strip.text = element_text(size = 18))+
stat_compare_means(comparisons = list(c("1","10")),
method.args = list(alternative = "greater"),
aes(label = ..p.signif..),
bracket.size = 1,size=5)+
facet_wrap(~sp)
ggplot(data=C1,aes(x=cat,y=rep))+
geom_pointrange(data=yd1P,aes(x=cat,y=inv(yv.fit),
ymin=inv(yv.fit-1.96*yv.se.fit),
ymax=inv((yv.fit+1.96*yv.se.fit)),
group=sp,color=sp),size=1)+
theme_classic() +
labs(y="Responding individuals (% PI = 1)",x="Trial")+
theme(plot.title = element_text(hjust = 0.5))+
theme(plot.title = element_text(size=22,face = "bold"))+
theme(axis.text=element_text(size=20,color="black"),
axis.title=element_text(size=20,color="black"))+
scale_color_manual(values=c("#531B93","#009193","#941751"))+
scale_fill_manual(values=c("#531B93","#009193","#941751"))+
theme(legend.title = element_text(size=20),
legend.text = element_text(size=20))+
guides(colour=guide_legend(title="Species"))+
theme(legend.position = "none",
strip.text = element_text(size = 18))+
stat_compare_means(comparisons = list(c("1","10")),
aes(label = ..p.signif..),
bracket.size = 1,size=5)+
facet_wrap(~sp)
ggplot(data=C1,aes(x=cat,y=dY))+
geom_pointrange(data=yd1V,aes(x=cat,y=inv(yv.fit),
ymin=inv(yv.fit-1.96*yv.se.fit),
ymax=inv((yv.fit+1.96*yv.se.fit)),
group=sp,color=sp),size=1)+
theme_classic() +
labs(y="Vertical Distance (mm)",x="Trial")+
theme(plot.title = element_text(hjust = 0.5))+
theme(plot.title = element_text(size=22,face = "bold"))+
theme(axis.text=element_text(size=20,color="black"),
axis.title=element_text(size=20,color="black"))+
scale_color_manual(values=c("#531B93","#009193","#941751"))+
scale_fill_manual(values=c("#531B93","#009193","#941751"))+
theme(legend.title = element_text(size=20),
legend.text = element_text(size=20))+
guides(colour=guide_legend(title="Species"))+
theme(legend.position = "none",
strip.text = element_text(size = 18))+
stat_compare_means(comparisons = list(c("1","10")),
method.args = list(alternative = "greater"),
aes(label = ..p.signif..),
bracket.size = 1,size=5)+
facet_wrap(~sp)
ggplot(data=C1,aes(x=cat,y=dY))+
geom_pointrange(data=yd1V,aes(x=cat,y=inv(yv.fit),
ymin=inv(yv.fit-1.96*yv.se.fit),
ymax=inv((yv.fit+1.96*yv.se.fit)),
group=sp,color=sp),size=1)+
theme_classic() +
labs(y="Vertical Distance (mm)",x="Trial")+
theme(plot.title = element_text(hjust = 0.5))+
theme(plot.title = element_text(size=22,face = "bold"))+
theme(axis.text=element_text(size=20,color="black"),
axis.title=element_text(size=20,color="black"))+
scale_color_manual(values=c("#531B93","#009193","#941751"))+
scale_fill_manual(values=c("#531B93","#009193","#941751"))+
theme(legend.title = element_text(size=20),
legend.text = element_text(size=20))+
guides(colour=guide_legend(title="Species"))+
theme(legend.position = "none",
strip.text = element_text(size = 18))+
stat_compare_means(comparisons = list(c("1","10")),
aes(label = ..p.signif..),
bracket.size = 1,size=5)+
facet_wrap(~sp)
ggplot(data=C1,aes(x=cat,y=rep))+
geom_pointrange(data=yd1P,aes(x=cat,y=inv(yv.fit),
ymin=inv(yv.fit-1.96*yv.se.fit),
ymax=inv((yv.fit+1.96*yv.se.fit)),
group=sp,color=sp),size=1)+
theme_classic() +
labs(y="Responding individuals (% PI = 1)",x="Trial")+
theme(plot.title = element_text(hjust = 0.5))+
theme(plot.title = element_text(size=22,face = "bold"))+
theme(axis.text=element_text(size=20,color="black"),
axis.title=element_text(size=20,color="black"))+
scale_color_manual(values=c("#531B93","#009193","#941751"))+
scale_fill_manual(values=c("#531B93","#009193","#941751"))+
theme(legend.title = element_text(size=20),
legend.text = element_text(size=20))+
guides(colour=guide_legend(title="Species"))+
theme(legend.position = "none",
strip.text = element_text(size = 18))+
facet_wrap(~sp)
mae<-glm(rep~cat*sp, data=C1, family="binomial")
yv <- predict(mae,type="link",se.fit=TRUE)
yAE<-data.frame(yv$fit,yv$se.fit,C1$cat,C1$ct,C1$sp)
yd1P<-yAE %>% rename(sp=C1.sp) %>% rename(cat=C1.cat)
ggplot(data=C1,aes(x=cat,y=rep))+
geom_pointrange(data=yd1P,aes(x=cat,y=inv(yv.fit),
ymin=inv(yv.fit-1.96*yv.se.fit),
ymax=inv((yv.fit+1.96*yv.se.fit)),
group=sp,color=sp),size=1)+
theme_classic() +
labs(y="Responding individuals (% PI = 1)",x="Trial")+
theme(plot.title = element_text(hjust = 0.5))+
theme(plot.title = element_text(size=22,face = "bold"))+
theme(axis.text=element_text(size=20,color="black"),
axis.title=element_text(size=20,color="black"))+
scale_color_manual(values=c("#531B93","#009193","#941751"))+
scale_fill_manual(values=c("#531B93","#009193","#941751"))+
theme(legend.title = element_text(size=20),
legend.text = element_text(size=20))+
guides(colour=guide_legend(title="Species"))+
theme(legend.position = "none",
strip.text = element_text(size = 18))+
facet_wrap(~sp)
## Libraries ----
library(dplyr)
library(car)
library(ggeffects)
library(ggplot2)
rm(list=ls())
set.seed(666) #Fix kernell
## Open files and add metadata ----
setwd("/Users/martin/Desktop/2)Data/5_Grouped")
Aedes<-read.table("Aedes.csv", sep="",header=T) %>% filter(gp=="Sti")
Aedes$cat<-as.factor(Aedes$cat)
Aedes$ID<-as.factor(Aedes$ID)
Aedes$ct<-as.factor(Aedes$ct)
Aedes$day<-as.factor(Aedes$day)
Aedes$pck<-as.factor(Aedes$pck)
Aedes$expe<-as.factor(Aedes$expe)
#str(Aedes)
Culex<-read.table("Culex.csv", sep="",header=T) %>% filter(gp=="Sti")
Culex$cat<-as.factor(Culex$cat)
Culex$ID<-as.factor(Culex$ID)
Culex$ct<-as.factor(Culex$ct)
Culex$day<-as.factor(Culex$day)
Culex$pck<-as.factor(Culex$pck)
Culex$expe<-as.factor(Culex$expe)
#str(Culex)
Anopheles<-read.table("Anopheles.csv", sep="",header=T) %>% filter(gp=="Sti")
Anopheles$cat<-as.factor(Anopheles$cat)
Anopheles$ID<-as.factor(Anopheles$ID)
Anopheles$ct<-as.factor(Anopheles$ct)
Anopheles$day<-as.factor(Anopheles$day)
Anopheles$pck<-as.factor(Anopheles$pck)
Anopheles$expe<-as.factor(Anopheles$expe)
#str(Anopheles)
## 2) A_ Apply threshold Aedes ----
# a. Define the maximum vertical position to distinguish
# between individuals who have not reacted and those who have reacted
lowl1 = -10 #mm
upl1 = +10 #mm
# b. Define the threshold for being "too low" to dive due to
# the physical constraints of our cuvette
l1<- max(Aedes$pos_y)-max(Aedes$pos_y)/10
# c. Create an interating "number" for each row per trial / ID / group
rawAe<-Aedes %>% group_by(ct,ID,cat) %>% mutate(numbering = row_number()) %>% ungroup()
# d. Create threshold: take "1" if individual is below the  threshold, "0" else
scasAe<-rawAe %>% group_by(ct,ID,cat) %>%
mutate(threshold = case_when(numbering==min(numbering) & pos_y>l1 ~ 1,TRUE~0)) %>% ungroup()
# e. Count thresholds and sum into "rep" variable
sfilterAe<-scasAe %>% group_by(ct,ID,cat) %>%
summarise(rep=sum(threshold,na.rm=T),
dY=sum(-dY,na.rm = T),
pos_y=mean(pos_y,na.rm=T)) %>%
filter(rep==0) %>% ungroup()
# f. Split positions according to the limit previously assessed
sposAe<-sfilterAe %>%
mutate(slope=case_when(dY < lowl1 ~ "down",
dY>upl1 ~ "up",
dY >= lowl1 & dY <= upl1 ~ "flat"))
# g. Extract and bind data
s5<-sposAe %>% filter(slope=="up") %>% mutate(rep=1)
s5b<-sposAe %>% filter(slope=="flat") %>% mutate(rep=0)
F_Aedes<-bind_rows(s5,s5b) %>% mutate(sp="Aedes aegypti")
rm(s5,s5b,sfilterAe,scasAe,sposAe,rawAe) #remove useless df
# h. Compare data between full df and df with rules
stvAe<-Aedes %>%
group_by(ct,ID,cat) %>%
summarise(dY=sum(-dY,na.rm = T),
pos_y=mean(pos_y,na.rm=T))
full<-stvAe %>% group_by(ct,cat) %>% count(ct,cat)
filtered<-F_Aedes %>% group_by(cat) %>% count(ct,cat)
rm(Aedes,stvAe,full,filtered) #remove useless df
## 2) B_ Apply threshold Culex ----
# a. Define the maximum vertical position to distinguish
# between individuals who have not reacted and those who have reacted
lowl1 = -10 #mm
upl1 = +10 #mm
# b. Define the threshold for being "too low" to dive due to
# the physical constraints of our cuvette
l1<- max(Culex$pos_y)-max(Culex$pos_y)/10
# c. Create an interating "number" for each row per trial / ID / group
rawCx<-Culex %>% group_by(ct,ID,cat) %>% mutate(numbering = row_number()) %>% ungroup()
# d. Create threshold: take "1" if individual is below the  threshold, "0" else
scasCx<-rawCx %>% group_by(ct,ID,cat) %>%
mutate(threshold = case_when(numbering==min(numbering) & pos_y>l1 ~ 1,TRUE~0)) %>% ungroup()
# e. Count thresholds and sum into "rep" variable
sfilterCx<-scasCx %>% group_by(ct,ID,cat) %>%
summarise(rep=sum(threshold,na.rm=T),
dY=sum(-dY,na.rm = T),
pos_y=mean(pos_y,na.rm=T)) %>%
filter(rep==0) %>% ungroup()
# f. Split positions according to the limit previously assessed
sposCx<-sfilterCx %>%
mutate(slope=case_when(dY < lowl1 ~ "down",
dY>upl1 ~ "up",
dY >= lowl1 & dY <= upl1 ~ "flat"))
# g. Extract and bind data
s5<-sposCx %>% filter(slope=="up") %>% mutate(rep=1)
s5b<-sposCx %>% filter(slope=="flat") %>% mutate(rep=0)
F_Culex<-bind_rows(s5,s5b) %>% mutate(sp="Culex")
rm(s5,s5b,sfilterCx,scasCx,sposCx,rawCx) #remove useless df
# h. Compare data between full df and df with rules
stvCx<-Culex %>%
group_by(ct,ID,cat) %>%
summarise(dY=sum(-dY,na.rm = T),
pos_y=mean(pos_y,na.rm=T))
full<-stvCx %>% group_by(ct,cat) %>% count(ct,cat)
filtered<-F_Culex %>% group_by(cat) %>% count(ct,cat)
rm(Culex,stvCx,full,filtered) #remove useless df
## 2) C_ Apply threshold Anopheles ----
# a. Define the maximum vertical position to distinguish
# between individuals who have not reacted and those who have reacted
lowl1 = -1 #mm
upl1 = +1 #mm
# b. Define the threshold for being "too low" to dive due to
# the physical constraints of our cuvette
l1<- max(Anopheles$pos_y)-max(Anopheles$pos_y)/10
# c. Create an interating "number" for each row per trial / ID / group
rawAn<-Anopheles %>% group_by(ct,ID,cat) %>% mutate(numbering = row_number()) %>% ungroup()
# d. Create threshold: take "1" if individual is below the  threshold, "0" else
scasAn<-rawAn %>% group_by(ct,ID,cat) %>%
mutate(threshold = case_when(numbering==min(numbering) & pos_y>l1 ~ 1,TRUE~0)) %>% ungroup()
# e. Count thresholds and sum into "rep" variable
sfilterAn<-scasAn %>% group_by(ct,ID,cat) %>%
summarise(rep=sum(threshold,na.rm=T),
dY=sum(-dY,na.rm = T),
pos_y=mean(pos_y,na.rm=T)) %>%
filter(rep==0) %>% ungroup()
# f. Split positions according to the limit previously assessed
sposAn<-sfilterAn %>%
mutate(slope=case_when(dY < lowl1 ~ "down",
dY>upl1 ~ "up",
dY >= lowl1 & dY <= upl1 ~ "flat"))
# g. Extract and bind data
s5<-sposAn %>% filter(slope=="up") %>% mutate(rep=1)
s5b<-sposAn %>% filter(slope=="flat") %>% mutate(rep=0)
F_Anopheles<-bind_rows(s5,s5b) %>% mutate(sp="Anopheles")
rm(s5,s5b,sfilterAn,scasAn,sposAn,rawAn) #remove useless df
# h. Compare data between full df and df with rules
stvAn<-Anopheles %>%
group_by(ct,ID,cat) %>%
summarise(dY=sum(-dY,na.rm = T),
pos_y=mean(pos_y,na.rm=T))
full<-stvAn %>% group_by(ct,cat) %>% count(ct,cat)
filtered<-F_Anopheles %>% group_by(cat) %>% count(ct,cat)
rm(Anopheles,stvAn,full,filtered) #remove useless df
C2_1<-F_Aedes %>%
filter(cat==12)
C2_2<-F_Aedes %>% filter(ct==3)
C2_Ae<-bind_rows(C2_1,C2_2) %>%
group_by(sp,ct,ID,cat) %>%
summarise(dY=mean(dY,na.rm = T),
rep=mean(rep,na.rm=T))
C2_1<-F_Culex %>%
filter(cat==12)
C2_2<-F_Culex %>% filter(ct==3)
C2_Cx<-bind_rows(C2_1,C2_2) %>%
group_by(sp,ct,ID,cat) %>%
summarise(dY=mean(dY,na.rm = T),
rep=mean(rep,na.rm=T))
C2_1<-F_Anopheles %>%
filter(cat==12)
C2_2<-F_Anopheles %>% filter(ct==3)
C2_An<-bind_rows(C2_1,C2_2) %>%
group_by(sp,ct,ID,cat) %>%
summarise(dY=mean(dY,na.rm = T),
rep=mean(rep,na.rm=T))
C2<-bind_rows(C2_Ae,C2_Cx,C2_An)
c1<-"Exp."
c2<-"Ct.1"
c3<-"Ct.2"
levels(C2$ct) <- c(c1,c2,c3)
mae<-glm(rep~ct*sp, data=C2,family="binomial")
yv <- predict(mae,type="link",se.fit=TRUE)
yAE<-data.frame(yv$fit,yv$se.fit,C2$cat,C2$ct,C2$sp)
yd2P<-yAE %>% rename(sp=C2.sp) %>% rename(cat=C2.cat) %>% rename(ct=C2.ct)
inv<-family(mae)$linkinv
ggplot(data=C2,aes(x=ct,y=rep))+
geom_pointrange(data=yd2P,aes(x=ct,y=inv(yv.fit),
ymin=inv(yv.fit-1.96*yv.se.fit),
ymax=inv((yv.fit+1.96*yv.se.fit)),
group=sp,color=sp),size=1)+
theme_classic() +
labs(y="Responding individuals (% PI = 1)",x="Group")+
theme(plot.title = element_text(hjust = 0.5))+
theme(plot.title = element_text(size=22,face = "bold"))+
theme(axis.text=element_text(size=20,color="black"),
axis.title=element_text(size=20,color="black"))+
scale_color_manual(values=c("#531B93","#009193","#941751"))+
theme(legend.title = element_text(size=20),
legend.text = element_text(size=20))+
guides(colour=guide_legend(title="Species"))+
theme(legend.position = "none",
strip.text = element_text(size = 18))+
facet_wrap(~sp)
mae<-glm(dY~ct*sp, data=C2)
yv <- predict(mae,type="link",se.fit=TRUE)
yAE<-data.frame(yv$fit,yv$se.fit,C2$cat,C2$ct,C2$sp)
yd2V<-yAE %>% rename(sp=C2.sp) %>% rename(cat=C2.cat) %>% rename(ct=C2.ct)
inv<-family(mae)$linkinv
ggplot(data=C2,aes(x=ct,y=dY))+
geom_pointrange(data=yd2V,aes(x=ct,y=inv(yv.fit),
ymin=inv(yv.fit-1.96*yv.se.fit),
ymax=inv((yv.fit+1.96*yv.se.fit)),
group=sp,color=sp),size=1)+
theme_classic() +
labs(y="Vertical Distance (mm)",x="Group")+
theme(plot.title = element_text(hjust = 0.5))+
theme(plot.title = element_text(size=22,face = "bold"))+
theme(axis.text=element_text(size=20,color="black"),
axis.title=element_text(size=20,color="black"))+
scale_color_manual(values=c("#531B93","#009193","#941751"))+
theme(legend.title = element_text(size=20),
legend.text = element_text(size=20))+
guides(colour=guide_legend(title="Species"))+
theme(legend.position = "none",
strip.text = element_text(size = 18))+
facet_wrap(~sp)
C3_Ae<-F_Aedes %>%
mutate(cat=case_when(cat==10 ~ "10",
cat==11 ~ "Dist",
cat==12 ~ "Test")) %>%
filter(ct==2) %>%
filter(cat=="10"|cat=="Dist"|cat=="Test") %>%
group_by(ct,sp,ID,cat) %>%
summarise(dY=mean(dY,na.rm = T),
rep=mean(rep,na.rm=T)) %>% ungroup()
C3_Cx<-F_Culex %>%
mutate(cat=case_when(cat==10 ~ "10",
cat==11 ~ "Dist",
cat==12 ~ "Test")) %>%
filter(ct==2) %>%
filter(cat=="10"|cat=="Dist"|cat=="Test") %>%
group_by(ct,sp,ID,cat) %>%
summarise(dY=mean(dY,na.rm = T),
rep=mean(rep,na.rm=T)) %>% ungroup()
C3_An<-F_Anopheles %>%
mutate(cat=case_when(cat==10 ~ "10",
cat==11 ~ "Dist",
cat==12 ~ "Test")) %>%
filter(ct==2) %>%
filter(cat=="10"|cat=="Dist"|cat=="Test") %>%
group_by(ct,sp,ID,cat) %>%
summarise(dY=mean(dY,na.rm = T),
rep=mean(rep,na.rm=T)) %>% ungroup()
C3<-bind_rows(C3_Ae,C3_Cx,C3_An)
mae<-glm(rep~cat*sp, data=C3,family="binomial")
yv <- predict(mae,type="link",se.fit=TRUE)
yAE<-data.frame(yv$fit,yv$se.fit,C3$cat,C3$ct,C3$sp)
yd3P<-yAE %>% rename(sp=C3.sp) %>% rename(cat=C3.cat)
inv<-family(mae)$linkinv
ggplot(data=C3,aes(x=cat,y=rep))+
geom_pointrange(data=yd3P,aes(x=cat,y=inv(yv.fit),
ymin=inv(yv.fit-1.96*yv.se.fit),
ymax=inv((yv.fit+1.96*yv.se.fit)),
group=sp,color=sp),size=1)+
theme_classic() +
labs(y="Responding individuals (% PI = 1)",x="Trial")+
theme(plot.title = element_text(hjust = 0.5))+
theme(plot.title = element_text(size=22,face = "bold"))+
theme(axis.text=element_text(size=20,color="black"),
axis.title=element_text(size=20,color="black"))+
scale_color_manual(values=c("#B830A0","#48DC92","#CF5450"))+
scale_fill_manual(values=c("#B830A0","#48DC92","#CF5450"))+
theme(legend.title = element_text(size=20),
legend.text = element_text(size=20))+
guides(colour=guide_legend(title="Species"))+
theme(legend.position = "none",
strip.text = element_text(size = 18))+
facet_wrap(~sp)
mae<-glm(dY~cat*sp, data=C3)
yv <- predict(mae,type="link",se.fit=TRUE)
yAE<-data.frame(yv$fit,yv$se.fit,C3$cat,C3$ct,C3$sp)
yd3V<-yAE %>% rename(sp=C3.sp) %>% rename(cat=C3.cat)
inv<-family(mae)$linkinv
ggplot(data=C3,aes(x=cat,y=dY))+
geom_pointrange(data=yd3V,aes(x=cat,y=inv(yv.fit),
ymin=inv(yv.fit-1.96*yv.se.fit),
ymax=inv((yv.fit+1.96*yv.se.fit)),
group=sp,color=sp),size=1)+
theme_classic() +
labs(y="Vertical Distance (mm)",x="Trial")+
theme(plot.title = element_text(hjust = 0.5))+
theme(plot.title = element_text(size=22,face = "bold"))+
theme(axis.text=element_text(size=20,color="black"),
axis.title=element_text(size=20,color="black"))+
scale_color_manual(values=c("#B830A0","#48DC92","#CF5450"))+
scale_fill_manual(values=c("#B830A0","#48DC92","#CF5450"))+
theme(legend.title = element_text(size=20),
legend.text = element_text(size=20))+
guides(colour=guide_legend(title="Species"))+
theme(legend.position = "none",
strip.text = element_text(size = 18))+
facet_wrap(~sp)
